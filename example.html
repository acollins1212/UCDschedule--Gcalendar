<html>
<head>

  <link rel="stylesheet" type="text/css" href="./mainstyle.css">
  <script type="text/javascript" src="scheduler.js"></script>
  
</head>
<body>

<script type="text/javascript">
 
      var CLIENT_ID = '939118948007-sdlatljv3k8rpir0m4anb2ub73i9sr6a.apps.googleusercontent.com';
      var SCOPES = ["https://www.googleapis.com/auth/calendar.readonly"];

      /**
       * Check if current user has authorized this application.
       */
      function checkAuth() {
        gapi.auth.authorize(
          {
            'client_id': CLIENT_ID,
            'scope': SCOPES.join(' '),
            'immediate': true
          }, handleAuthResult);
      }

      /**
       * Handle response from authorization server.
       *
       * @param {Object} authResult Authorization result.
       */
      function handleAuthResult(authResult) {
        var authorizeDiv = document.getElementById('authorize-div');
        if (authResult && !authResult.error) {
          // Hide auth UI, then load client library.
          authorizeDiv.style.display = 'none';
        } else {
          // Show auth UI, allowing the user to initiate authorization by
          // clicking authorize button.
          authorizeDiv.style.display = 'inline';
        }
      }

      /**
       * Initiate auth flow in response to user clicking authorize button.
       *
       * @param {Event} event Button click event.
       */
      function handleAuthClick(event) {
        gapi.auth.authorize(
          {client_id: CLIENT_ID, scope: SCOPES, immediate: false},
          handleAuthResult);
        return false;
      }

      /**
       * Load Google Calendar client library. List upcoming events
       * once client library is loaded.
       */
      function loadCalendarApi() {
        gapi.client.load('calendar', 'v3', insertAllCourses);
      }


      /**
       * Append a pre element to the body containing the given message
       * as its text node.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('output');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

    </script>
    <script src="https://apis.google.com/js/client.js?onload=checkAuth"></script>


<script type="text/javascript">

	var CALENDAR_ID = ''; 
	CALENDAR_ID = CALENDAR_ID.trim();

	function insertAllCourses() {
		COURSE_ARRAY = [];
		var numCourses = 5;

		for (var i = 0; i < numCourses; i++) {
			var currentCourse = getCourse(i);


			for(var j = 0; j < getCourse(i).meeting_array.length; j++) {


	        var event = currentCourse.getEventJSON(j);

	        var request = gapi.client.calendar.events.insert({
	        'calendarId': CALENDAR_ID,
	        'resource': event
	        });

	        request.execute(function(event) {
	          //appendPre('Event created: ' +   event.htmlLink);

	        });

	      } //inner for

	      //insert the Final Exam event
	      var final_exam = currentCourse.getFinalJSON();

	      var request = gapi.client.calendar.events.insert({
	       'calendarId': CALENDAR_ID,
	       'resource': final_exam
	      });

	      request.execute(function(final_exam) {
	        //appendPre('Final created: ' +   final_exam.htmlLink);

	      });
	    } //outer for
			
	} //insertAllCourses()

	function getCourse(i) {

		//These are the ID's for course elements
		var courseKey = 'course' + i; //course i
		var sectionKey = i + 'section'; 
		var descriptionKey = 'desc' + i; //desc  i
		var finalDateKey = 'finalDate' + i;
		var finalTimeKey = 'finalTime' + i;

		//Using the ID's from above, get the values inputted
		var course_id = document.getElementById(courseKey).value;
		var section = document.getElementById(sectionKey).value;
		var desc = document.getElementById(descriptionKey).value;
		var finalDate = document.getElementById(finalDateKey).value;
   		var finalTime = document.getElementById(finalTimeKey).value;

   		c = new Course(course_id, section, desc, finalDate, finalTime);

   		//Get number of meetings for this course
		var numMeetingsKey = i + "numMeetings";
		var numMeetings = document.getElementById(numMeetingsKey).value;

		for (var j = 0; j < numMeetings; j++) {

			//Get the meeting values out of the text boxes
			var meetingTypeKey = i + 'meetingType' + j;
        	var startTimeKey = i + 'startTime' + j;
			var endTimeKey = i + 'endTime' + j;
			var locationKey = i + 'location' + j;
			var daysOfWeekKey = i + 'daysOfWeek' + j;
			var type = document.getElementById(meetingTypeKey).value;
			var start = document.getElementById(startTimeKey).value;
			var end = document.getElementById(endTimeKey).value;
			var loc = document.getElementById(locationKey).value;
			var dow = document.getElementById(daysOfWeekKey).value;

			c.addMeeting(type, start, end, loc, dow);
		} //inner for
		return c; //return the course created

	} //getCourse(i)

</script>


<div id="main-container">
	<div id="header">
	<h1 >Your Schedule</h1>
	<h4>Please double check that these were read correctly before inserting them into your Google Calendar</h4>
	</div>

<div id="authorize-div" style="display: none">
      <span>Authorize access to Google Calendar API</span>
      <!--Button for the user to click to initiate auth sequence -->
      <button id="authorize-button" onclick="handleAuthClick(event)">
        Authorize
      </button>
</div>

<div class="two-tables"><table class="left-course-table"><col style="width:20%"> <col style="width:40%"><col style="width:40%"><thead><tr><th><input type="text" id="course0" value="ECS 122A"></th><th><input type="text" id="desc0" value="Algorithm Design
"></th><th><input type="text" id="0section" value="A02"></th></tr><tr><td>Final Exam: </td><td><input type="text" id="finalDate0" value="3/21/2017"><td><input type="text" id="finalTime0" value="6:00 PM"></td></tr></thead><th><input type="hidden" id="0numMeetings" value="2" ></th><tr><td><input type="text" id="0meetingType0" value="Lecture"></td><td><input type="text" id="0startTime0" value="11:00 AM" ></td><td><input type="text" id="0endTime0" value="11:50 AM" ></td></tr><tr><td>@</td><td><input type="text" id="0location0" value="Giedt 1003
"></td><td><input type="text" id="0daysOfWeek0" value="MO,WE,FR"></td></tr><tr><td><input type="text" id="0meetingType1" value="Discussion"></td><td><input type="text" id="0startTime1" value="9:00 AM" ></td><td><input type="text" id="0endTime1" value="9:50 AM" ></td></tr><tr><td>@</td><td><input type="text" id="0location1" value="Olson Hall 158
"></td><td><input type="text" id="0daysOfWeek1" value="MO"></td></tr></table><table class="right-course-table"><col style="width:20%"> <col style="width:40%"><col style="width:40%"><thead><tr><th><input type="text" id="course1" value="ECS 140A"></th><th><input type="text" id="desc1" value="Programming Languages
"></th><th><input type="text" id="1section" value="A01"></th></tr><tr><td>Final Exam: </td><td><input type="text" id="finalDate1" value="3/20/2017"><td><input type="text" id="finalTime1" value="8:00 AM"></td></tr></thead><th><input type="hidden" id="1numMeetings" value="2" ></th><tr><td><input type="text" id="1meetingType0" value="Lecture"></td><td><input type="text" id="1startTime0" value="9:00 AM" ></td><td><input type="text" id="1endTime0" value="10:20 AM" ></td></tr><tr><td>@</td><td><input type="text" id="1location0" value="Giedt 1002
"></td><td><input type="text" id="1daysOfWeek0" value="TU,TH"></td></tr><tr><td><input type="text" id="1meetingType1" value="Discussion"></td><td><input type="text" id="1startTime1" value="5:10 PM" ></td><td><input type="text" id="1endTime1" value="6:00 PM" ></td></tr><tr><td>@</td><td><input type="text" id="1location1" value="Olson Hall 158
"></td><td><input type="text" id="1daysOfWeek1" value="WE"></td></tr></table></div><div class="two-tables"><table class="left-course-table"><col style="width:20%"> <col style="width:40%"><col style="width:40%"><thead><tr><th><input type="text" id="course2" value="ECS 150"></th><th><input type="text" id="desc2" value="Operating Systems
"></th><th><input type="text" id="2section" value="001"></th></tr><tr><td>Final Exam: </td><td><input type="text" id="finalDate2" value="3/24/2017"><td><input type="text" id="finalTime2" value="8:30 PM"></td></tr></thead><th><input type="hidden" id="2numMeetings" value="2" ></th><tr><td><input type="text" id="2meetingType0" value="Lecture"></td><td><input type="text" id="2startTime0" value="7:40 PM" ></td><td><input type="text" id="2endTime0" value="9:00 PM" ></td></tr><tr><td>@</td><td><input type="text" id="2location0" value="Everson Hall 176
"></td><td><input type="text" id="2daysOfWeek0" value="TU,TH"></td></tr><tr><td><input type="text" id="2meetingType1" value="Discussion"></td><td><input type="text" id="2startTime1" value="7:10 PM" ></td><td><input type="text" id="2endTime1" value="8:00 PM" ></td></tr><tr><td>@</td><td><input type="text" id="2location1" value="Everson Hall 176
"></td><td><input type="text" id="2daysOfWeek1" value="WE"></td></tr></table><table class="right-course-table"><col style="width:20%"> <col style="width:40%"><col style="width:40%"><thead><tr><th><input type="text" id="course3" value="SPA 111N"></th><th><input type="text" id="desc3" value="Sounds and Words
"></th><th><input type="text" id="3section" value="001"></th></tr><tr><td>Final Exam: </td><td><input type="text" id="finalDate3" value="3/23/2017"><td><input type="text" id="finalTime3" value="8:00 AM"></td></tr></thead><th><input type="hidden" id="3numMeetings" value="1" ></th><tr><td><input type="text" id="3meetingType0" value="Lecture"></td><td><input type="text" id="3startTime0" value="12:10 PM" ></td><td><input type="text" id="3endTime0" value="1:00 PM" ></td></tr><tr><td>@</td><td><input type="text" id="3location0" value="Chemistry 176
"></td><td><input type="text" id="3daysOfWeek0" value="MO,WE,FR"></td></tr></table></div><div class="two-tables"><table class="left-course-table"><col style="width:20%"> <col style="width:40%"><col style="width:40%"><thead><tr><th><input type="text" id="course4" value="ECS 130"></th><th><input type="text" id="desc4" value="Scientific Computation
"></th><th><input type="text" id="4section" value="A01"></th></tr><tr><td>Final Exam: </td><td><input type="text" id="finalDate4" value="3/20/2017"><td><input type="text" id="finalTime4" value="3:30 PM"></td></tr></thead><th><input type="hidden" id="4numMeetings" value="2" ></th><tr><td><input type="text" id="4meetingType0" value="Lecture"></td><td><input type="text" id="4startTime0" value="3:10 PM" ></td><td><input type="text" id="4endTime0" value="4:00 PM" ></td></tr><tr><td>@</td><td><input type="text" id="4location0" value="Young Hall 194
"></td><td><input type="text" id="4daysOfWeek0" value="MO,WE,FR"></td></tr><tr><td><input type="text" id="4meetingType1" value="Discussion"></td><td><input type="text" id="4startTime1" value="5:10 PM" ></td><td><input type="text" id="4endTime1" value="6:00 PM" ></td></tr><tr><td>@</td><td><input type="text" id="4location1" value="Art 217"></td><td><input type="text" id="4daysOfWeek1" value="TH"></td></tr></table></div><input type="hidden" id="numCourses" value="5" >

<div style="clear: both; text-align: center; margin-top: 10px;">
<button id="loadCalendarApi-button" onclick="loadCalendarApi()">Insert Events</button>
</div>
<br>
<br>
<p id="footer" > sb2cal.com </p>

</div> <!-- Close main-container-->





<pre id="output"></pre>


</body>
</html>
